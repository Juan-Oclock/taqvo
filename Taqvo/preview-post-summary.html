<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Post Summary Preview</title>
  <style>
    body { background:#0d0f14; color:#eaeaea; font-family:-apple-system,BlinkMacSystemFont,"Helvetica Neue",Arial; }
    .container { max-width: 820px; margin: 24px auto; padding: 16px; }
    .card { background:#11151d; border-radius:16px; padding:20px; box-shadow:0 4px 24px rgba(0,0,0,0.45); }
    .topbar { display:flex; gap:8px; }
    .input { flex:1; background:#0a0d12; color:#eaeaea; border:1px solid #1c2230; border-radius:10px; padding:10px 12px; }
    .btn { background:#29a36a; border:none; color:#0b130f; font-weight:600; padding:10px 14px; border-radius:10px; }
    h2 { margin:16px 0 8px; }
    .metrics { display:flex; gap:16px; margin-top:8px; }
    .metric { flex:1; background:#0a0d12; border:1px solid #1c2230; border-radius:12px; padding:10px; }
    .metric .label { color:#8aa0a6; font-size:12px; }
    .metric .value { font-size:18px; color:#eaeaea; font-weight:600; }
    .footer { display:flex; gap:12px; margin-top:16px; }
    .share { background:#fff; color:#0b130f; border-radius:10px; padding:10px; font-weight:600; }
    .cta { background:#29a36a; color:#0b130f; border-radius:10px; padding:10px; font-weight:600; }
  </style>
</head>
<body>
  <div class="container">
    <div class="card">
      <div class="topbar">
        <input id="titleInput" class="input" placeholder="Title (optional) â€” e.g., Morning Run" />
        <button id="applyBtn" class="btn">Apply</button>
      </div>
      <h2 id="header">Ran 5.00 km</h2>
      <div class="metrics">
        <div class="metric"><div class="label">Duration</div><div class="value" id="duration">00:25:00</div></div>
        <div class="metric"><div class="label">Avg Pace</div><div class="value" id="pace">5:00 min/km</div></div>
        <div class="metric"><div class="label">Calories</div><div class="value" id="calories">250 kcal</div></div>
      </div>
      <div class="footer">
        <div class="share">Share Image</div>
        <div class="cta">Share to Feed</div>
      </div>
    </div>
  </div>
  <script>
    const params = new URLSearchParams(location.search);
    const dist = Number(params.get('distanceMeters') || 5000);
    const dur = Number(params.get('durationSeconds') || 1500);
    const kcal = Number(params.get('caloriesKilocalories') || 250);
    const kind = (params.get('kind') || 'run').toLowerCase();
    const verb = { walk: 'Walked', jog: 'Jogged', run: 'Ran', ride: 'Rode' }[kind] || 'Ran';
    const header = document.getElementById('header');
    const durEl = document.getElementById('duration');
    const paceEl = document.getElementById('pace');
    const calEl = document.getElementById('calories');

    const fmtDuration = (secs) => {
      const s = Math.max(0, Math.floor(secs));
      const h = Math.floor(s / 3600), m = Math.floor((s % 3600) / 60), r = s % 60;
      return h > 0 ? `${h}:${String(m).padStart(2,'0')}:${String(r).padStart(2,'0')}` : `${m}:${String(r).padStart(2,'0')}`;
    };
    const paceStr = (() => {
      if (dist <= 1 || dur <= 0) return '--';
      const mpk = dur / (dist / 1000.0);
      const m = Math.floor(mpk / 60), s = Math.round(mpk % 60);
      return `${m}:${String(s).padStart(2,'0')} min/km`;
    })();

    function updateHeaderFromTitle(title) {
      const t = (title || '').trim();
      header.textContent = t.length > 0 ? t : `${verb} ${ (dist/1000).toFixed(2) } km`;
    }

    // Initialize from query
    updateHeaderFromTitle(params.get('title'));
    durEl.textContent = fmtDuration(dur);
    paceEl.textContent = paceStr;
    calEl.textContent = `${Math.round(kcal)} kcal`;

    // Topbar apply
    const input = document.getElementById('titleInput');
    input.value = params.get('title') || '';
    document.getElementById('applyBtn').onclick = () => updateHeaderFromTitle(input.value);
  </script>
</body>
</html>